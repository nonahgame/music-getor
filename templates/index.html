<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LyricBeats AI - Real Music + Video</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
    body { background:#000; color:#0f0; font-family:monospace; }
    .card { background:#111; border:2px solid #0f0; box-shadow:0 0 20px #0f0; }
    textarea { background:#000; color:#0f0; border:2px solid #0f0; }
    .counter { color:#f00; font-weight:bold; }
    .neon { text-shadow:0 0 15px #0f0; }
    .spinner-large { width:4rem; height:4rem; }
</style>
</head>

<body class="p-4">

<div class="container">
    <h1 class="text-center neon mb-4">LYRICBEATS AI</h1>

    <div class="card p-4">

        <form id="f">

            <div class="mb-3">
                <input type="text" class="form-control" id="title" placeholder="Song Title" required>
            </div>

            <textarea class="form-control" id="lyrics" rows="10" placeholder="Paste lyrics..." required></textarea>

            <div class="text-end counter">
                Chars: <span id="c">0</span>/6000 | Words: <span id="w">0</span>
            </div>

            <div class="row mt-3">

                <div class="col-md-3">
                    <select class="form-select" id="genre">
                        <option>hip-hop</option>
                        <option>pop</option>
                        <option>r&b</option>
                    </select>
                </div>

                <div class="col-md-3">
                    <select class="form-select" id="voice">
                        <option>Male Rapper</option>
                        <option>Female Soulful</option>
                    </select>
                </div>

                <div class="col-md-3">
                    <select class="form-select" id="format">
                        <option value="high_mp4">Music Video (MP4)</option>
                        <option value="simple_mp4">Simple MP4</option>
                        <option value="mp3">MP3</option>
                        <option value="wav">WAV</option>
                    </select>
                </div>

                <div class="col-md-3">
                    <button type="submit" id="btn" class="btn btn-success w-100">GENERATE</button>
                </div>

            </div>

        </form>

        <div id="res" class="mt-4"></div>

    </div>
</div>

<script>
    // Live character/word counter
    document.getElementById('lyrics').addEventListener('input', e => {
        let t = e.target.value;
        document.getElementById('c').textContent = t.length;
        document.getElementById('w').textContent = t.trim() ? t.trim().split(/\s+/).length : 0;
    });

    // Form submission handler
    document.getElementById('f').onsubmit = async e => {
        e.preventDefault();

        // Disable button while generating
        document.getElementById('btn').disabled = true;
        document.getElementById('btn').textContent = "Generating...";

        document.getElementById('res').innerHTML = `
            <h3>Generating real song... Please wait 2–6 minutes</h3>
            <div class="d-flex justify-content-center mt-3">
                <div class="spinner-border text-success spinner-large"></div>
            </div>
        `;

        await fetch('/generate', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                title: document.getElementById('title').value,
                lyrics: document.getElementById('lyrics').value,
                genre: document.getElementById('genre').value,
                voice_type: document.getElementById('voice').value,
                file_format: document.getElementById('format').value
            })
        });

        // Success message
        document.getElementById('res').innerHTML = `
            <h3 class="text-success">✔ Song Generated Successfully!</h3>
            <p>Find your files in the:</p>
            <ul>
                <li><b>output/</b> folder (server)</li>
                <li><b>public_downloads/</b> folder (browser download)</li>
                <li><b><a href="https://github.com/YOUR_GITHUB_USERNAME/YOUR_REPO_NAME/tree/main/d-output" target="_blank" style="color:#0ff;">GitHub d-output folder</a></b> (auto uploaded)</li>
            </ul>
            <p>Refresh the GitHub page after 60 seconds to see your files.</p>
        `;

        // Re-enable button
        document.getElementById('btn').disabled = false;
        document.getElementById('btn').textContent = "GENERATE";
    };
</script>

</body>
</html>
